{% extends "base.html" %}
{% block content %}

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">{% trans %}Recent donations{% endtrans %}:</h3>
    </div>
    <div class="panel-body">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>{% trans %}Date{% endtrans %}</th>
                    <th>{% trans %}Amount{% endtrans %}</th>
                    <th>{% trans %}Currency{% endtrans %}</th>
                    <th>{% trans %}Comment{% endtrans %}</th>
                </tr>
            </thead>
            <tbody>
                {% for donation in donations %}
                    <tr>
                        <td>{{ donation.timestamp | datetimeformat }}</td>
                        <td>{{ donation.amount }}</td>
                        <td>{{ donation.currency }}</td>
                        <td>{{ donation.comment }}</td>
                    </tr>
                {% else %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">{% trans %}Donate today and get nothing!{% endtrans %}</h3>
    </div>
    <div class="panel-body">
        <div class="row">
            <div class="col-md-12">
                <button type="button" class="btn btn-success" onclick="show_btc_donation();"><i class="fa fa-btc"></i> Donate via Bitcoin</button>
            </div>
        </div>
        <div id="btc-donation-panel" class="row well" style="display:none;">
            <div class="col-md-12">
                <p>
                    Thank you for taking this important step of supporting your local radio channel.<br>
                    Your money will be spend wisely on drugs, hookers and, if something is left, on the server bills
                </p>
            </div>
            <div class="col-md-12">
                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-5 control-label">Please send your coins to this address</label>
                    <div class="col-sm-7">
                      <input class="form-control"  type="text" value="" id="btc-address">
                    </div>
                  </div>
            </div>
        </div>
    </div>
</div>
<script>
    function show_btc_donation() {

        if ($('#btc-donation-panel').is(':visible')) {
            $('#btc-donation-panel').hide( "fast" );
        } else {
            get_btc_address();
            $('#btc-donation-panel').show( "fast" );
        }
    }

    function get_btc_address() {
        if ($('#btc-address').val() != '') {
            return;
        }
        $.ajax({url: "/api/site/donation/getaddress"})
            .done(function( data ) {
                    if (data.success) {
                        $('#btc-address').val(data.address);
                    }
                  }
        );
    }

</script>

{% endblock %}